0: /mnt/netapp2/Store_uni/home/ulc/cursos/curso386/mytorchdist/lib/python3.9/site-packages/lightning_fabric/connector.py:565: `precision=16` is supported for historical reasons but its usage is discouraged. Please set your precision to 16-mixed instead!
0: Using 16bit Automatic Mixed Precision (AMP)
0: GPU available: True (cuda), used: True
0: TPU available: False, using: 0 TPU cores
0: IPU available: False, using: 0 IPUs
0: HPU available: False, using: 0 HPUs
3: Initializing distributed: GLOBAL_RANK: 3, MEMBER: 4/4
2: Initializing distributed: GLOBAL_RANK: 2, MEMBER: 3/4
1: Initializing distributed: GLOBAL_RANK: 1, MEMBER: 2/4
0: Initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/4
0: ----------------------------------------------------------------------------------------------------
0: distributed_backend=nccl
0: All distributed processes registered. Starting with 4 processes
0: ----------------------------------------------------------------------------------------------------
0: 
2: LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
0: LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
3: LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1]
1: LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1]
0: 
0:    | Name     | Type               | Params
0: -------------------------------------------------
0: 0  | fc1      | Linear             | 100 K 
0: 1  | fc2      | Linear             | 16.5 K
0: 2  | fc3      | Linear             | 16.5 K
0: 3  | fc4      | Linear             | 16.5 K
0: 4  | fc5      | Linear             | 16.5 K
0: 5  | fc6      | Linear             | 16.5 K
0: 6  | fc7      | Linear             | 16.5 K
0: 7  | fc8      | Linear             | 16.5 K
0: 8  | fc9      | Linear             | 16.5 K
0: 9  | fc10     | Linear             | 16.5 K
0: 10 | fc11     | Linear             | 16.5 K
0: 11 | fc12     | Linear             | 1.3 K 
0: 12 | loss_fn  | CrossEntropyLoss   | 0     
0: 13 | accuracy | MulticlassAccuracy | 0     
0: 14 | f1_score | MulticlassF1Score  | 0     
0: -------------------------------------------------
0: 266 K     Trainable params
0: 0         Non-trainable params
0: 266 K     Total params
0: 1.068     Total estimated model params size (MB)
3: SLURM auto-requeueing enabled. Setting signal handlers.
0: SLURM auto-requeueing enabled. Setting signal handlers.
2: SLURM auto-requeueing enabled. Setting signal handlers.
1: SLURM auto-requeueing enabled. Setting signal handlers.
3: [W kineto_shim.cpp:343] Profiler is not initialized: skipping step() invocation
3: [W kineto_shim.cpp:330] Profiler is not initialized: skipping profiling metadata
3: [W kineto_shim.cpp:343] Profiler is not initialized: skipping step() invocation
3: [W kineto_shim.cpp:330] Profiler is not initialized: skipping profiling metadata
1: [W kineto_shim.cpp:343] Profiler is not initialized: skipping step() invocation
1: [W kineto_shim.cpp:330] Profiler is not initialized: skipping profiling metadata
2: [W kineto_shim.cpp:343] Profiler is not initialized: skipping step() invocation
2: [W kineto_shim.cpp:330] Profiler is not initialized: skipping profiling metadata
2: [W kineto_shim.cpp:343] Profiler is not initialized: skipping step() invocation
1: [W kineto_shim.cpp:343] Profiler is not initialized: skipping step() invocation
2: [W kineto_shim.cpp:330] Profiler is not initialized: skipping profiling metadata
1: [W kineto_shim.cpp:330] Profiler is not initialized: skipping profiling metadata
0: [W kineto_shim.cpp:343] Profiler is not initialized: skipping step() invocation
0: [W kineto_shim.cpp:330] Profiler is not initialized: skipping profiling metadata
0: [W kineto_shim.cpp:343] Profiler is not initialized: skipping step() invocation
0: [W kineto_shim.cpp:330] Profiler is not initialized: skipping profiling metadata
2: [W kineto_shim.cpp:343] Profiler is not initialized: skipping step() invocation
2: [W kineto_shim.cpp:330] Profiler is not initialized: skipping profiling metadata
1: [W kineto_shim.cpp:343] Profiler is not initialized: skipping step() invocation
1: [W kineto_shim.cpp:330] Profiler is not initialized: skipping profiling metadata
3: [W kineto_shim.cpp:343] Profiler is not initialized: skipping step() invocation
3: [W kineto_shim.cpp:330] Profiler is not initialized: skipping profiling metadata
0: [W kineto_shim.cpp:343] Profiler is not initialized: skipping step() invocation
0: [W kineto_shim.cpp:330] Profiler is not initialized: skipping profiling metadata
2: [W kineto_shim.cpp:343] Profiler is not initialized: skipping step() invocation
3: [W kineto_shim.cpp:343] Profiler is not initialized: skipping step() invocation
2: [W kineto_shim.cpp:330] Profiler is not initialized: skipping profiling metadata
3: [W kineto_shim.cpp:330] Profiler is not initialized: skipping profiling metadata
1: [W kineto_shim.cpp:343] Profiler is not initialized: skipping step() invocation
1: [W kineto_shim.cpp:330] Profiler is not initialized: skipping profiling metadata
0: [W kineto_shim.cpp:343] Profiler is not initialized: skipping step() invocation
0: [W kineto_shim.cpp:330] Profiler is not initialized: skipping profiling metadata
3: [W kineto_shim.cpp:343] Profiler is not initialized: skipping step() invocation
3: [W kineto_shim.cpp:330] Profiler is not initialized: skipping profiling metadata
2: [W kineto_shim.cpp:343] Profiler is not initialized: skipping step() invocation
2: [W kineto_shim.cpp:330] Profiler is not initialized: skipping profiling metadata
1: [W kineto_shim.cpp:343] Profiler is not initialized: skipping step() invocation
1: [W kineto_shim.cpp:330] Profiler is not initialized: skipping profiling metadata
0: [W kineto_shim.cpp:343] Profiler is not initialized: skipping step() invocation
0: [W kineto_shim.cpp:330] Profiler is not initialized: skipping profiling metadata
3: [W kineto_shim.cpp:343] Profiler is not initialized: skipping step() invocation
3: [W kineto_shim.cpp:330] Profiler is not initialized: skipping profiling metadata
2: [W kineto_shim.cpp:343] Profiler is not initialized: skipping step() invocation
2: [W kineto_shim.cpp:330] Profiler is not initialized: skipping profiling metadata
1: [W kineto_shim.cpp:343] Profiler is not initialized: skipping step() invocation
1: [W kineto_shim.cpp:330] Profiler is not initialized: skipping profiling metadata
0: [W kineto_shim.cpp:343] Profiler is not initialized: skipping step() invocation
0: [W kineto_shim.cpp:330] Profiler is not initialized: skipping profiling metadata
2: [W kineto_shim.cpp:343] Profiler is not initialized: skipping step() invocation
2: [W kineto_shim.cpp:330] Profiler is not initialized: skipping profiling metadata
1: [W kineto_shim.cpp:343] Profiler is not initialized: skipping step() invocation
1: [W kineto_shim.cpp:330] Profiler is not initialized: skipping profiling metadata
0: [W kineto_shim.cpp:343] Profiler is not initialized: skipping step() invocation
0: [W kineto_shim.cpp:330] Profiler is not initialized: skipping profiling metadata
3: [W kineto_shim.cpp:343] Profiler is not initialized: skipping step() invocation
3: [W kineto_shim.cpp:330] Profiler is not initialized: skipping profiling metadata
2: [W kineto_shim.cpp:343] Profiler is not initialized: skipping step() invocation
2: [W kineto_shim.cpp:330] Profiler is not initialized: skipping profiling metadata
1: [W kineto_shim.cpp:343] Profiler is not initialized: skipping step() invocation
1: [W kineto_shim.cpp:330] Profiler is not initialized: skipping profiling metadata
3: [W kineto_shim.cpp:343] Profiler is not initialized: skipping step() invocation
3: [W kineto_shim.cpp:330] Profiler is not initialized: skipping profiling metadata
0: [W kineto_shim.cpp:343] Profiler is not initialized: skipping step() invocation
0: [W kineto_shim.cpp:330] Profiler is not initialized: skipping profiling metadata
3: [W kineto_shim.cpp:343] Profiler is not initialized: skipping step() invocation
3: [W kineto_shim.cpp:330] Profiler is not initialized: skipping profiling metadata
1: [W kineto_shim.cpp:343] Profiler is not initialized: skipping step() invocation
1: [W kineto_shim.cpp:330] Profiler is not initialized: skipping profiling metadata
2: [W kineto_shim.cpp:343] Profiler is not initialized: skipping step() invocation
2: [W kineto_shim.cpp:330] Profiler is not initialized: skipping profiling metadata
0: [W kineto_shim.cpp:343] Profiler is not initialized: skipping step() invocation
0: [W kineto_shim.cpp:330] Profiler is not initialized: skipping profiling metadata
3: [W kineto_shim.cpp:343] Profiler is not initialized: skipping step() invocation
2: [W kineto_shim.cpp:343] Profiler is not initialized: skipping step() invocation
2: [W kineto_shim.cpp:330] Profiler is not initialized: skipping profiling metadata
3: [W kineto_shim.cpp:330] Profiler is not initialized: skipping profiling metadata
1: [W kineto_shim.cpp:343] Profiler is not initialized: skipping step() invocation
1: [W kineto_shim.cpp:330] Profiler is not initialized: skipping profiling metadata
0: [W kineto_shim.cpp:343] Profiler is not initialized: skipping step() invocation
0: [W kineto_shim.cpp:330] Profiler is not initialized: skipping profiling metadata
2: [W kineto_shim.cpp:343] Profiler is not initialized: skipping step() invocation
2: [W kineto_shim.cpp:330] Profiler is not initialized: skipping profiling metadata
1: [W kineto_shim.cpp:343] Profiler is not initialized: skipping step() invocation
1: [W kineto_shim.cpp:330] Profiler is not initialized: skipping profiling metadata
3: [W kineto_shim.cpp:343] Profiler is not initialized: skipping step() invocation
3: [W kineto_shim.cpp:330] Profiler is not initialized: skipping profiling metadata
0: [W kineto_shim.cpp:343] Profiler is not initialized: skipping step() invocation
0: [W kineto_shim.cpp:330] Profiler is not initialized: skipping profiling metadata
3: [W kineto_shim.cpp:343] Profiler is not initialized: skipping step() invocation
3: [W kineto_shim.cpp:330] Profiler is not initialized: skipping profiling metadata
2: [W kineto_shim.cpp:343] Profiler is not initialized: skipping step() invocation
2: [W kineto_shim.cpp:330] Profiler is not initialized: skipping profiling metadata
1: [W kineto_shim.cpp:343] Profiler is not initialized: skipping step() invocation
1: [W kineto_shim.cpp:330] Profiler is not initialized: skipping profiling metadata
0: [W kineto_shim.cpp:343] Profiler is not initialized: skipping step() invocation
0: [W kineto_shim.cpp:330] Profiler is not initialized: skipping profiling metadata
2: STAGE:2023-12-15 23:40:36 1021672:1021672 ActivityProfilerController.cpp:311] Completed Stage: Warm Up
3: STAGE:2023-12-15 23:40:36 1021673:1021673 ActivityProfilerController.cpp:311] Completed Stage: Warm Up
0: STAGE:2023-12-15 23:40:36 1792673:1792673 ActivityProfilerController.cpp:311] Completed Stage: Warm Up
1: STAGE:2023-12-15 23:40:36 1792674:1792674 ActivityProfilerController.cpp:311] Completed Stage: Warm Up
3: STAGE:2023-12-15 23:40:36 1021673:1021673 ActivityProfilerController.cpp:317] Completed Stage: Collection
2: STAGE:2023-12-15 23:40:36 1021672:1021672 ActivityProfilerController.cpp:317] Completed Stage: Collection
1: STAGE:2023-12-15 23:40:36 1792674:1792674 ActivityProfilerController.cpp:317] Completed Stage: Collection
0: STAGE:2023-12-15 23:40:36 1792673:1792673 ActivityProfilerController.cpp:317] Completed Stage: Collection
3: STAGE:2023-12-15 23:40:36 1021673:1021673 ActivityProfilerController.cpp:321] Completed Stage: Post Processing
2: STAGE:2023-12-15 23:40:36 1021672:1021672 ActivityProfilerController.cpp:321] Completed Stage: Post Processing
1: STAGE:2023-12-15 23:40:36 1792674:1792674 ActivityProfilerController.cpp:321] Completed Stage: Post Processing
0: STAGE:2023-12-15 23:40:36 1792673:1792673 ActivityProfilerController.cpp:321] Completed Stage: Post Processing
3: [W collection.cpp:496] Warning: [pl][profile][LightningModule]NN.optimizer_step (function operator())
2: [W collection.cpp:496] Warning: [pl][profile][LightningModule]NN.optimizer_step (function operator())
1: [W collection.cpp:496] Warning: [pl][profile][LightningModule]NN.optimizer_step (function operator())
0: [W collection.cpp:496] Warning: [pl][profile][LightningModule]NN.optimizer_step (function operator())
3: STAGE:2023-12-15 23:40:40 1021673:1021673 ActivityProfilerController.cpp:311] Completed Stage: Warm Up
0: STAGE:2023-12-15 23:40:40 1792673:1792673 ActivityProfilerController.cpp:311] Completed Stage: Warm Up
2: STAGE:2023-12-15 23:40:40 1021672:1021672 ActivityProfilerController.cpp:311] Completed Stage: Warm Up
3: STAGE:2023-12-15 23:40:40 1021673:1021673 ActivityProfilerController.cpp:317] Completed Stage: Collection
1: STAGE:2023-12-15 23:40:40 1792674:1792674 ActivityProfilerController.cpp:311] Completed Stage: Warm Up
3: STAGE:2023-12-15 23:40:40 1021673:1021673 ActivityProfilerController.cpp:321] Completed Stage: Post Processing
2: STAGE:2023-12-15 23:40:40 1021672:1021672 ActivityProfilerController.cpp:317] Completed Stage: Collection
2: STAGE:2023-12-15 23:40:40 1021672:1021672 ActivityProfilerController.cpp:321] Completed Stage: Post Processing
0: STAGE:2023-12-15 23:40:40 1792673:1792673 ActivityProfilerController.cpp:317] Completed Stage: Collection
0: STAGE:2023-12-15 23:40:40 1792673:1792673 ActivityProfilerController.cpp:321] Completed Stage: Post Processing
1: STAGE:2023-12-15 23:40:40 1792674:1792674 ActivityProfilerController.cpp:317] Completed Stage: Collection
1: STAGE:2023-12-15 23:40:40 1792674:1792674 ActivityProfilerController.cpp:321] Completed Stage: Post Processing
0: /mnt/netapp2/Store_uni/home/ulc/cursos/curso386/mytorchdist/lib/python3.9/site-packages/pytorch_lightning/trainer/connectors/logger_connector/result.py:433: It is recommended to use `self.log('train_loss', ..., sync_dist=True)` when logging on epoch level in distributed setting to accumulate the metric across devices.
0: /mnt/netapp2/Store_uni/home/ulc/cursos/curso386/mytorchdist/lib/python3.9/site-packages/pytorch_lightning/trainer/connectors/logger_connector/result.py:433: It is recommended to use `self.log('train_acc', ..., sync_dist=True)` when logging on epoch level in distributed setting to accumulate the metric across devices.
0: /mnt/netapp2/Store_uni/home/ulc/cursos/curso386/mytorchdist/lib/python3.9/site-packages/pytorch_lightning/trainer/connectors/logger_connector/result.py:433: It is recommended to use `self.log('train_f1', ..., sync_dist=True)` when logging on epoch level in distributed setting to accumulate the metric across devices.
0: `Trainer.fit` stopped: `max_epochs=20` reached.
0: FIT Profiler Report
0: Profile stats for: records rank: 0
0: -------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
0:                                                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls  
0: -------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
0:                                           ProfilerStep*         7.42%      11.375ms        99.98%     153.283ms       7.664ms       0.000us         0.00%       7.541ms     377.050us            20  
0:      [pl][profile][Strategy]DDPStrategy.validation_step         1.07%       1.645ms        75.47%     115.706ms       5.785ms       0.000us         0.00%       7.253ms     362.650us            20  
0:                         DistributedDataParallel.forward         6.92%      10.605ms        74.40%     114.061ms       5.703ms       0.000us         0.00%       7.253ms     362.650us            20  
0:                                            aten::linear         1.19%       1.819ms        69.01%     105.794ms     220.404us       0.000us         0.00%       7.422ms      15.463us           480  
0:                                                aten::to         1.33%       2.045ms        28.17%      43.184ms      69.877us       0.000us         0.00%       3.442ms       5.570us           618  
0:                                          aten::_to_copy         1.40%       2.143ms        27.78%      42.596ms      76.064us       0.000us         0.00%       3.572ms       6.379us           560  
0:                                             aten::addmm        13.82%      21.186ms        20.54%      31.495ms     131.229us       2.180ms        28.91%       2.180ms       9.083us           240  
0:                                             aten::copy_        12.46%      19.096ms        16.06%      24.617ms      42.443us       3.701ms        49.08%       3.701ms       6.381us           580  
0:                                     aten::empty_strided        11.37%      17.431ms        11.37%      17.431ms      30.053us       0.000us         0.00%       0.000us       0.000us           580  
0:                                              aten::relu         1.97%       3.014ms         9.78%      14.991ms      68.141us       0.000us         0.00%       1.100ms       5.000us           220  
0:                 [pl][profile][_EvaluationLoop].val_next         0.61%     930.000us         9.36%      14.351ms     717.550us       0.000us         0.00%       0.000us       0.000us            20  
0: enumerate(DataLoader)#_MultiProcessingDataLoaderIter...         8.56%      13.125ms         8.75%      13.421ms     671.050us       0.000us         0.00%       0.000us       0.000us            20  
0:                                         aten::clamp_min         6.78%      10.393ms         7.81%      11.977ms      54.441us       1.100ms        14.59%       1.100ms       5.000us           220  
0:         [pl][module]torch.nn.modules.linear.Linear: fc1         0.38%     580.000us         6.08%       9.315ms     465.750us       0.000us         0.00%     823.000us      41.150us            20  
0:                                        cudaLaunchKernel         5.29%       8.109ms         5.29%       8.109ms       7.372us       0.000us         0.00%       0.000us       0.000us          1100  
0:                                             aten::empty         4.64%       7.109ms         4.64%       7.109ms      25.572us       0.000us         0.00%       0.000us       0.000us           278  
0:      [pl][profile][Strategy]DDPStrategy.batch_to_device         1.09%       1.669ms         4.39%       6.724ms     336.200us       0.000us         0.00%     288.000us      14.400us            20  
0:         [pl][module]torch.nn.modules.linear.Linear: fc2         0.14%     218.000us         4.27%       6.552ms     327.600us       0.000us         0.00%     460.000us      23.000us            20  
0:         [pl][module]torch.nn.modules.linear.Linear: fc3         0.30%     455.000us         4.14%       6.341ms     317.050us       0.000us         0.00%     400.000us      20.000us            20  
0:         [pl][module]torch.nn.modules.linear.Linear: fc4         0.20%     300.000us         4.08%       6.259ms     312.950us       0.000us         0.00%     403.000us      20.150us            20  
0: -------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
0: Self CPU time total: 153.308ms
0: Self CUDA time total: 7.541ms
0: 
2: FIT Profiler Report
2: Profile stats for: records rank: 0
2: -------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
2:                                                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls  
2: -------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
2:                                           ProfilerStep*        14.87%      11.168ms        99.98%      75.071ms       3.754ms       0.000us         0.00%       7.366ms     368.300us            20  
2:      [pl][profile][Strategy]DDPStrategy.validation_step         2.15%       1.611ms        59.32%      44.540ms       2.227ms       0.000us         0.00%       7.085ms     354.250us            20  
2:                         DistributedDataParallel.forward        13.57%      10.191ms        57.17%      42.929ms       2.146ms       0.000us         0.00%       7.085ms     354.250us            20  
2:                                            aten::linear         1.98%       1.485ms        39.41%      29.592ms      61.650us       0.000us         0.00%       7.225ms      15.052us           480  
2:                 [pl][profile][_EvaluationLoop].val_next         0.72%     541.000us        16.58%      12.447ms     622.350us       0.000us         0.00%       0.000us       0.000us            20  
2: enumerate(DataLoader)#_MultiProcessingDataLoaderIter...        15.49%      11.634ms        15.86%      11.906ms     595.300us       0.000us         0.00%       0.000us       0.000us            20  
2:                                                aten::to         1.54%       1.158ms        15.54%      11.671ms      18.824us       0.000us         0.00%       3.180ms       5.129us           620  
2:                                          aten::_to_copy         2.74%       2.061ms        14.88%      11.173ms      19.952us       0.000us         0.00%       3.439ms       6.141us           560  
2:                                             aten::addmm         7.63%       5.729ms        10.41%       7.819ms      32.579us       2.111ms        28.66%       2.111ms       8.796us           240  
2:                                             aten::copy_         4.16%       3.120ms         9.60%       7.209ms      12.429us       3.615ms        49.08%       3.615ms       6.233us           580  
2:                                        cudaLaunchKernel         7.40%       5.554ms         7.40%       5.554ms       5.049us       0.000us         0.00%       0.000us       0.000us          1100  
2:      [pl][profile][Strategy]DDPStrategy.batch_to_device         2.20%       1.655ms         6.29%       4.722ms     236.100us       0.000us         0.00%     281.000us      14.050us            20  
2:                                              aten::relu         0.98%     737.000us         5.11%       3.837ms      17.441us       0.000us         0.00%       1.101ms       5.005us           220  
2:         [pl][module]torch.nn.modules.linear.Linear: fc1         0.71%     535.000us         4.80%       3.607ms     180.350us       0.000us         0.00%     761.000us      38.050us            20  
2:                                         aten::clamp_min         2.65%       1.991ms         4.13%       3.100ms      14.091us       1.101ms        14.95%       1.101ms       5.005us           220  
2: [pl][profile][LightningModule]NN.transfer_batch_to_d...         1.25%     937.000us         3.81%       2.860ms     143.000us       0.000us         0.00%     281.000us      14.050us            20  
2:                                     aten::empty_strided         3.36%       2.521ms         3.36%       2.521ms       4.347us       0.000us         0.00%       0.000us       0.000us           580  
2:         [pl][module]torch.nn.modules.linear.Linear: fc2         0.59%     441.000us         2.97%       2.230ms     111.500us       0.000us         0.00%     407.000us      20.350us            20  
2:         [pl][module]torch.nn.modules.linear.Linear: fc3         0.57%     430.000us         2.69%       2.021ms     101.050us       0.000us         0.00%     402.000us      20.100us            20  
2:         [pl][module]torch.nn.modules.linear.Linear: fc4         0.50%     377.000us         2.63%       1.975ms      98.750us       0.000us         0.00%     402.000us      20.100us            20  
2: -------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
2: Self CPU time total: 75.089ms
2: Self CUDA time total: 7.366ms
2: 
2: LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
0: LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
3: LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1]
1: LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1]
2: SLURM auto-requeueing enabled. Setting signal handlers.
0: SLURM auto-requeueing enabled. Setting signal handlers.
3: SLURM auto-requeueing enabled. Setting signal handlers.
1: SLURM auto-requeueing enabled. Setting signal handlers.
0: /mnt/netapp2/Store_uni/home/ulc/cursos/curso386/mytorchdist/lib/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:232: Using `DistributedSampler` with the dataloaders. During `trainer.validate()`, it is recommended to use `Trainer(devices=1, num_nodes=1)` to ensure each sample/batch gets evaluated exactly once. Otherwise, multi-device settings use `DistributedSampler` that replicates some samples to make sure all devices have same batch size in case of uneven inputs.
2: STAGE:2023-12-15 23:41:30 1021672:1021672 ActivityProfilerController.cpp:311] Completed Stage: Warm Up
3: STAGE:2023-12-15 23:41:30 1021673:1021673 ActivityProfilerController.cpp:311] Completed Stage: Warm Up
0: STAGE:2023-12-15 23:41:30 1792673:1792673 ActivityProfilerController.cpp:311] Completed Stage: Warm Up
1: STAGE:2023-12-15 23:41:30 1792674:1792674 ActivityProfilerController.cpp:311] Completed Stage: Warm Up
2: STAGE:2023-12-15 23:41:30 1021672:1021672 ActivityProfilerController.cpp:317] Completed Stage: Collection
3: STAGE:2023-12-15 23:41:30 1021673:1021673 ActivityProfilerController.cpp:317] Completed Stage: Collection
2: STAGE:2023-12-15 23:41:30 1021672:1021672 ActivityProfilerController.cpp:321] Completed Stage: Post Processing
3: STAGE:2023-12-15 23:41:30 1021673:1021673 ActivityProfilerController.cpp:321] Completed Stage: Post Processing
1: STAGE:2023-12-15 23:41:30 1792674:1792674 ActivityProfilerController.cpp:317] Completed Stage: Collection
0: STAGE:2023-12-15 23:41:30 1792673:1792673 ActivityProfilerController.cpp:317] Completed Stage: Collection
1: STAGE:2023-12-15 23:41:30 1792674:1792674 ActivityProfilerController.cpp:321] Completed Stage: Post Processing
0: STAGE:2023-12-15 23:41:30 1792673:1792673 ActivityProfilerController.cpp:321] Completed Stage: Post Processing
0: VALIDATE Profiler Report
0: Profile stats for: records rank: 0
0: -------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
0:                                                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls  
0: -------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
0:                                           ProfilerStep*         7.33%      11.197ms        99.99%     152.730ms       7.636ms       0.000us         0.00%       7.525ms     376.250us            20  
0:      [pl][profile][Strategy]DDPStrategy.validation_step         7.00%      10.697ms        75.42%     115.200ms       5.760ms       0.000us         0.00%       7.241ms     362.050us            20  
0:                                            aten::linear         0.47%     711.000us        70.49%     107.676ms     224.325us       0.000us         0.00%       7.336ms      15.283us           480  
0:                                                aten::to         2.33%       3.561ms        28.85%      44.063ms      71.069us       0.000us         0.00%       3.269ms       5.273us           620  
0:                                          aten::_to_copy         1.45%       2.219ms        28.50%      43.528ms      77.729us       0.000us         0.00%       3.539ms       6.320us           560  
0:                                             aten::addmm        14.04%      21.441ms        21.03%      32.126ms     133.858us       2.174ms        28.89%       2.174ms       9.058us           240  
0:                                             aten::copy_        12.85%      19.635ms        16.50%      25.199ms      43.447us       3.689ms        49.02%       3.689ms       6.360us           580  
0:                                     aten::empty_strided        11.72%      17.907ms        11.72%      17.907ms      30.874us       0.000us         0.00%       0.000us       0.000us           580  
0:                                              aten::relu         1.85%       2.825ms         9.65%      14.739ms      66.995us       0.000us         0.00%       1.104ms       5.018us           220  
0:                 [pl][profile][_EvaluationLoop].val_next         0.62%     943.000us         9.41%      14.369ms     718.450us       0.000us         0.00%       0.000us       0.000us            20  
0: enumerate(DataLoader)#_MultiProcessingDataLoaderIter...         8.71%      13.308ms         8.79%      13.426ms     671.300us       0.000us         0.00%       0.000us       0.000us            20  
0:                                         aten::clamp_min         6.81%      10.408ms         7.80%      11.914ms      54.155us       1.104ms        14.67%       1.104ms       5.018us           220  
0:         [pl][module]torch.nn.modules.linear.Linear: fc1         0.37%     561.000us         6.11%       9.331ms     466.550us       0.000us         0.00%     820.000us      41.000us            20  
0:                                        cudaLaunchKernel         5.23%       7.984ms         5.23%       7.984ms       7.258us       0.000us         0.00%       0.000us       0.000us          1100  
0:                                             aten::empty         4.97%       7.594ms         4.97%       7.594ms      27.121us       0.000us         0.00%       0.000us       0.000us           280  
0:      [pl][profile][Strategy]DDPStrategy.batch_to_device         1.10%       1.675ms         4.47%       6.826ms     341.300us       0.000us         0.00%     284.000us      14.200us            20  
0:         [pl][module]torch.nn.modules.linear.Linear: fc2         0.03%      48.000us         4.29%       6.559ms     327.950us       0.000us         0.00%     454.000us      22.700us            20  
0:         [pl][module]torch.nn.modules.linear.Linear: fc3         0.31%     466.000us         4.22%       6.446ms     322.300us       0.000us         0.00%     400.000us      20.000us            20  
0:        [pl][module]torch.nn.modules.linear.Linear: fc12        -0.02%     -30.000us         4.20%       6.413ms     320.650us       0.000us         0.00%     421.000us      21.050us            20  
0:         [pl][module]torch.nn.modules.linear.Linear: fc5         0.20%     302.000us         4.19%       6.401ms     320.050us       0.000us         0.00%     402.000us      20.100us            20  
0: -------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
0: Self CPU time total: 152.750ms
0: Self CUDA time total: 7.525ms
0: 
2: VALIDATE Profiler Report
2: Profile stats for: records rank: 0
2: -------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
2:                                                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls  
2: -------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
2:                                           ProfilerStep*        15.00%      11.044ms        99.97%      73.600ms       3.680ms       0.000us         0.00%       7.924ms     396.200us            20  
2:      [pl][profile][Strategy]DDPStrategy.validation_step        13.94%      10.260ms        60.06%      44.219ms       2.211ms       0.000us         0.00%       7.624ms     381.200us            20  
2:                                            aten::linear         2.04%       1.504ms        42.59%      31.353ms      65.319us       0.000us         0.00%       7.751ms      16.148us           480  
2:                                                aten::to         2.11%       1.552ms        16.60%      12.224ms      19.844us       0.000us         0.00%       3.469ms       5.631us           616  
2:                                          aten::_to_copy         2.86%       2.107ms        15.78%      11.617ms      20.745us       0.000us         0.00%       3.791ms       6.770us           560  
2:                 [pl][profile][_EvaluationLoop].val_next         0.83%     612.000us        15.08%      11.100ms     555.000us       0.000us         0.00%       0.000us       0.000us            20  
2: enumerate(DataLoader)#_MultiProcessingDataLoaderIter...        14.07%      10.360ms        14.25%      10.488ms     524.400us       0.000us         0.00%       0.000us       0.000us            20  
2:                                             aten::addmm         8.29%       6.102ms        11.67%       8.591ms      35.796us       2.182ms        27.54%       2.182ms       9.092us           240  
2:                                             aten::copy_         4.62%       3.399ms        10.34%       7.611ms      13.122us       4.061ms        51.25%       4.061ms       7.002us           580  
2:                                        cudaLaunchKernel         7.79%       5.736ms         7.79%       5.736ms       5.215us       0.000us         0.00%       0.000us       0.000us          1100  
2:      [pl][profile][Strategy]DDPStrategy.batch_to_device         2.23%       1.639ms         6.62%       4.873ms     243.650us       0.000us         0.00%     300.000us      15.000us            20  
2:         [pl][module]torch.nn.modules.linear.Linear: fc1         0.71%     524.000us         5.09%       3.746ms     187.300us       0.000us         0.00%     832.000us      41.600us            20  
2:                                              aten::relu         0.86%     633.000us         5.08%       3.737ms      16.986us       0.000us         0.00%       1.119ms       5.086us           220  
2:                                         aten::clamp_min         2.69%       1.981ms         4.22%       3.104ms      14.109us       1.119ms        14.12%       1.119ms       5.086us           220  
2: [pl][profile][LightningModule]NN.transfer_batch_to_d...         1.37%       1.009ms         4.07%       2.995ms     149.750us       0.000us         0.00%     300.000us      15.000us            20  
2:                                     aten::empty_strided         3.58%       2.639ms         3.58%       2.639ms       4.550us       0.000us         0.00%       0.000us       0.000us           580  
2:         [pl][module]torch.nn.modules.linear.Linear: fc2         0.58%     428.000us         3.03%       2.232ms     111.600us       0.000us         0.00%     460.000us      23.000us            20  
2:         [pl][module]torch.nn.modules.linear.Linear: fc7         0.47%     347.000us         2.91%       2.141ms     107.050us       0.000us         0.00%     441.000us      22.050us            20  
2:         [pl][module]torch.nn.modules.linear.Linear: fc3         0.51%     372.000us         2.91%       2.139ms     106.950us       0.000us         0.00%     440.000us      22.000us            20  
2:         [pl][module]torch.nn.modules.linear.Linear: fc6         0.47%     344.000us         2.88%       2.120ms     106.000us       0.000us         0.00%     440.000us      22.000us            20  
2: -------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
2: Self CPU time total: 73.621ms
2: Self CUDA time total: 7.924ms
2: 
2: LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
0: LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
3: LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1]
1: LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1]
2: SLURM auto-requeueing enabled. Setting signal handlers.
0: SLURM auto-requeueing enabled. Setting signal handlers.
3: SLURM auto-requeueing enabled. Setting signal handlers.
1: SLURM auto-requeueing enabled. Setting signal handlers.
0: /mnt/netapp2/Store_uni/home/ulc/cursos/curso386/mytorchdist/lib/python3.9/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:232: Using `DistributedSampler` with the dataloaders. During `trainer.test()`, it is recommended to use `Trainer(devices=1, num_nodes=1)` to ensure each sample/batch gets evaluated exactly once. Otherwise, multi-device settings use `DistributedSampler` that replicates some samples to make sure all devices have same batch size in case of uneven inputs.
2: STAGE:2023-12-15 23:41:31 1021672:1021672 ActivityProfilerController.cpp:311] Completed Stage: Warm Up
3: STAGE:2023-12-15 23:41:31 1021673:1021673 ActivityProfilerController.cpp:311] Completed Stage: Warm Up
0: STAGE:2023-12-15 23:41:31 1792673:1792673 ActivityProfilerController.cpp:311] Completed Stage: Warm Up
1: STAGE:2023-12-15 23:41:31 1792674:1792674 ActivityProfilerController.cpp:311] Completed Stage: Warm Up
2: STAGE:2023-12-15 23:41:31 1021672:1021672 ActivityProfilerController.cpp:317] Completed Stage: Collection
2: STAGE:2023-12-15 23:41:31 1021672:1021672 ActivityProfilerController.cpp:321] Completed Stage: Post Processing
3: STAGE:2023-12-15 23:41:31 1021673:1021673 ActivityProfilerController.cpp:317] Completed Stage: Collection
3: STAGE:2023-12-15 23:41:31 1021673:1021673 ActivityProfilerController.cpp:321] Completed Stage: Post Processing
0: STAGE:2023-12-15 23:41:31 1792673:1792673 ActivityProfilerController.cpp:317] Completed Stage: Collection
1: STAGE:2023-12-15 23:41:31 1792674:1792674 ActivityProfilerController.cpp:317] Completed Stage: Collection
0: STAGE:2023-12-15 23:41:31 1792673:1792673 ActivityProfilerController.cpp:321] Completed Stage: Post Processing
1: STAGE:2023-12-15 23:41:31 1792674:1792674 ActivityProfilerController.cpp:321] Completed Stage: Post Processing
0: TEST Profiler Report
0: Profile stats for: records rank: 0
0: -------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
0:                                                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls  
0: -------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
0:                                           ProfilerStep*         7.61%      11.836ms        99.99%     155.594ms       7.780ms       0.000us         0.00%       7.534ms     376.700us            20  
0:            [pl][profile][Strategy]DDPStrategy.test_step         7.21%      11.214ms        74.72%     116.280ms       5.814ms       0.000us         0.00%       7.247ms     362.350us            20  
0:                                            aten::linear         0.87%       1.348ms        69.40%     107.995ms     224.990us       0.000us         0.00%       7.402ms      15.421us           480  
0:                                                aten::to         1.89%       2.937ms        28.37%      44.141ms      71.195us       0.000us         0.00%       3.365ms       5.427us           620  
0:                                          aten::_to_copy         1.48%       2.305ms        27.91%      43.435ms      77.562us       0.000us         0.00%       3.548ms       6.336us           560  
0:                                             aten::addmm        13.81%      21.495ms        20.58%      32.026ms     133.442us       2.177ms        28.90%       2.177ms       9.071us           240  
0:                                             aten::copy_        12.55%      19.528ms        16.07%      25.000ms      43.103us       3.697ms        49.07%       3.697ms       6.374us           580  
0:                                     aten::empty_strided        11.54%      17.962ms        11.54%      17.962ms      30.969us       0.000us         0.00%       0.000us       0.000us           580  
0:                [pl][profile][_EvaluationLoop].test_next         0.58%     905.000us        10.03%      15.614ms     780.700us       0.000us         0.00%       0.000us       0.000us            20  
0:                                              aten::relu         1.82%       2.838ms         9.55%      14.863ms      67.559us       0.000us         0.00%       1.102ms       5.009us           220  
0: enumerate(DataLoader)#_MultiProcessingDataLoaderIter...         9.37%      14.581ms         9.45%      14.709ms     735.450us       0.000us         0.00%       0.000us       0.000us            20  
0:                                         aten::clamp_min         6.73%      10.469ms         7.73%      12.025ms      54.659us       1.102ms        14.63%       1.102ms       5.009us           220  
0:         [pl][module]torch.nn.modules.linear.Linear: fc1         0.36%     554.000us         6.13%       9.546ms     477.300us       0.000us         0.00%     823.000us      41.150us            20  
0:                                        cudaLaunchKernel         5.23%       8.134ms         5.23%       8.134ms       7.395us       0.000us         0.00%       0.000us       0.000us          1100  
0:                                             aten::empty         4.70%       7.315ms         4.70%       7.315ms      26.125us       0.000us         0.00%       0.000us       0.000us           280  
0:      [pl][profile][Strategy]DDPStrategy.batch_to_device         1.12%       1.739ms         4.39%       6.837ms     341.850us       0.000us         0.00%     287.000us      14.350us            20  
0:         [pl][module]torch.nn.modules.linear.Linear: fc2         0.33%     509.000us         4.32%       6.720ms     336.000us       0.000us         0.00%     457.000us      22.850us            20  
0:         [pl][module]torch.nn.modules.linear.Linear: fc3         0.31%     489.000us         4.13%       6.430ms     321.500us       0.000us         0.00%     401.000us      20.050us            20  
0:         [pl][module]torch.nn.modules.linear.Linear: fc5         0.19%     298.000us         4.13%       6.422ms     321.100us       0.000us         0.00%     401.000us      20.050us            20  
0:         [pl][module]torch.nn.modules.linear.Linear: fc8         0.09%     146.000us         4.12%       6.413ms     320.650us       0.000us         0.00%     401.000us      20.050us            20  
0: -------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
0: Self CPU time total: 155.614ms
0: Self CUDA time total: 7.534ms
0: 
2: TEST Profiler Report
2: Profile stats for: records rank: 0
2: -------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
2:                                                    Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls  
2: -------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
2:                                           ProfilerStep*        15.04%      11.823ms        99.98%      78.596ms       3.930ms       0.000us         0.00%       7.918ms     395.900us            20  
2:            [pl][profile][Strategy]DDPStrategy.test_step        13.87%      10.905ms        59.31%      46.629ms       2.331ms       0.000us         0.00%       7.618ms     380.900us            20  
2:                                            aten::linear         2.45%       1.924ms        42.67%      33.545ms      69.885us       0.000us         0.00%       7.731ms      16.106us           480  
2:                [pl][profile][_EvaluationLoop].test_next         0.88%     695.000us        16.26%      12.781ms     639.050us       0.000us         0.00%       0.000us       0.000us            20  
2:                                                aten::to         1.82%       1.434ms        16.17%      12.710ms      20.566us       0.000us         0.00%       3.580ms       5.793us           618  
2: enumerate(DataLoader)#_MultiProcessingDataLoaderIter...        15.18%      11.936ms        15.37%      12.086ms     604.300us       0.000us         0.00%       0.000us       0.000us            20  
2:                                          aten::_to_copy         2.90%       2.281ms        15.36%      12.072ms      21.557us       0.000us         0.00%       3.882ms       6.932us           560  
2:                                             aten::addmm         8.22%       6.460ms        11.35%       8.920ms      37.167us       2.184ms        27.58%       2.184ms       9.100us           240  
2:                                             aten::copy_         4.34%       3.414ms         9.88%       7.771ms      13.398us       4.063ms        51.31%       4.063ms       7.005us           580  
2:                                        cudaLaunchKernel         7.63%       5.996ms         7.63%       5.996ms       5.451us       0.000us         0.00%       0.000us       0.000us          1100  
2:      [pl][profile][Strategy]DDPStrategy.batch_to_device         2.17%       1.709ms         6.38%       5.016ms     250.800us       0.000us         0.00%     300.000us      15.000us            20  
2:         [pl][module]torch.nn.modules.linear.Linear: fc1         0.70%     552.000us         5.10%       4.012ms     200.600us       0.000us         0.00%     832.000us      41.600us            20  
2:                                              aten::relu         0.81%     636.000us         4.81%       3.780ms      17.182us       0.000us         0.00%       1.114ms       5.064us           220  
2:                                         aten::clamp_min         2.58%       2.026ms         4.00%       3.144ms      14.291us       1.114ms        14.07%       1.114ms       5.064us           220  
2: [pl][profile][LightningModule]NN.transfer_batch_to_d...         1.32%       1.039ms         3.90%       3.063ms     153.150us       0.000us         0.00%     300.000us      15.000us            20  
2:                                     aten::empty_strided         3.37%       2.651ms         3.37%       2.651ms       4.571us       0.000us         0.00%       0.000us       0.000us           580  
2:         [pl][module]torch.nn.modules.linear.Linear: fc2         0.66%     517.000us         3.21%       2.520ms     126.000us       0.000us         0.00%     460.000us      23.000us            20  
2:         [pl][module]torch.nn.modules.linear.Linear: fc3         0.59%     464.000us         2.86%       2.246ms     112.300us       0.000us         0.00%     440.000us      22.000us            20  
2:         [pl][module]torch.nn.modules.linear.Linear: fc6         0.50%     395.000us         2.83%       2.221ms     111.050us       0.000us         0.00%     441.000us      22.050us            20  
2:        [pl][module]torch.nn.modules.linear.Linear: fc11         0.45%     354.000us         2.81%       2.209ms     110.450us       0.000us         0.00%     440.000us      22.000us            20  
2: -------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
2: Self CPU time total: 78.615ms
2: Self CUDA time total: 7.918ms
2: 
